[build]
  builder = "nixpacks"

[phases.setup]
  nixPkgs = ["php82", "php82Packages.composer", "nodejs"]

[phases.install]
  cmds = ["cd backend && composer install --no-interaction --prefer-dist --optimize-autoloader"]

[phases.build]
  cmds = [
    "cd backend && npm install",
    "cd backend && npm run build"
  ]

[start]
  cmd = "cd backend && php artisan serve --host=0.0.0.0 --port=$PORT"
